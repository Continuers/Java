# 4.è¯·æ±‚å’Œå“åº”

## Httpåè®®

## 1.è¯·æ±‚æ¶ˆæ¯ï¼š

**å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨ç«¯çš„æ•°æ®(æ•°æ®æ ¼å¼)**

### 1.è¯·æ±‚è¡Œ

(https://www.bilibili.com/video/BV1qv4y1o79t?p=243&spm_id_from=pageDriver)

* **è¯·æ±‚æ–¹å¼   è¯·æ±‚url   è¯·æ±‚åè®®/ç‰ˆæœ¬**
* **GET     /login.html     HTTP/1.1**



* **è¯·æ±‚æ–¹å¼ï¼š**

	* **HTTPåè®®æœ‰7ç§è¯·æ±‚æ–¹å¼ï¼Œå¸¸ç”¨çš„æœ‰2ç§**

	* **GETï¼š**

		* **1.è¯·æ±‚å‚æ•°åœ¨è¯·æ±‚è¡Œä¸­ï¼Œåœ¨urlå**
		* **2.è¯·æ±‚çš„urlé•¿åº¦æœ‰é™åˆ¶çš„**
		* **3.ä¸å¤ªå®‰å…¨**

	* **POSTï¼š**

		* **1.è¯·æ±‚å‚æ•°åœ¨è¯·æ±‚ä½“ä¸­**
		* **2.è¯·æ±‚çš„urlé•¿åº¦æ²¡æœ‰é™åˆ¶çš„**
		* **3.ç›¸å¯¹å®‰å…¨**

		

### 2.è¯·æ±‚å¤´ï¼š

**å®¢æˆ·ç«¯æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ä¸€äº›ä¿¡æ¯**

* **è¯·æ±‚å¤´åç§°ï¼šè¯·æ±‚å¤´å€¼**

* **å¸¸è§çš„è¯·æ±‚å¤´ï¼š**

#### 1.User-Agentï¼š

**æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘è®¿é—®ä½ ä½¿ç”¨çš„æµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯**

* **å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è·å–è¯¥å¤´çš„ä¿¡æ¯ï¼Œè§£å†³æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜**

#### 2.Refererï¼š

**http://localhost/login.html**

* **å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘ï¼ˆå½“å‰è¯·æ±‚ï¼‰ä»å“ªé‡Œæ¥?**
* **ä½œç”¨**
	* **1.é˜²ç›—é“¾ï¼š**
	* **2.ç»Ÿè®¡å·¥ä½œï¼š**



### 3.è¯·æ±‚ç©ºè¡Œ

* **ç©ºè¡Œï¼Œå°±æ˜¯ç”¨äºåˆ†å‰²POSTè¯·æ±‚å¤´ï¼Œå’Œè¯·æ±‚ä½“çš„**



### 4.è¯·æ±‚ä½“ï¼ˆæ­£æ–‡ï¼‰

* **å°è£…POSTè¯·æ±‚æ¶ˆæ¯çš„è¯·æ±‚å‚æ•°çš„**



### 5.å­—ç¬¦ä¸²æ ¼å¼ï¼š

â€‹		POST/login.html	HTTP/1.1
â€‹		Host: localhost
â€‹		User-agent: Mozilla/5. 0(Windows NT 6. 1; Win64; X64; rv: 60. 0)Gecko/20100101 **Firefox**/60.0
â€‹		Accept: text/html, application/xhtml+xml, application/xml; q=0.9, "/;q=0.8
â€‹		Accept-language: zh-cn, zh; q=0.8, zh-tw; q=0. 7, zh-hk; q=0.5, en-us; q=0.3, en; q=0.2
â€‹		Accept-Encoding: gzip, deflate
â€‹		Refererï¼šhttp://localhost/login.html
â€‹		Connection: keep-alive
â€‹		Upgrade-insecure-requests: 1

â€‹		username=zhangsan



## 2.å“åº”å¼æ¶ˆæ¯ï¼š

**æœåŠ¡å™¨ç«¯å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®(æ•°æ®æ ¼å¼)**

### 1.å“åº”è¡Œ

#### 1.ç»„æˆï¼šåè®®/ç‰ˆæœ¬  å“åº”çŠ¶æ€ç  çŠ¶æ€ç æè¿°

#### 2.å“åº”çŠ¶æ€ç ï¼šæœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯æµè§ˆå™¨æœ¬æ¬¡è¯·æ±‚å’Œå“åº”çš„ä¸€ä¸ªçŠ¶æ€

* **1.çŠ¶æ€ç éƒ½æ˜¯3ä½æ•°å­—**
* **2.åˆ†ç±»ï¼š**
	* **1XXï¼šæœåŠ¡å™¨å°±æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯,ä½†æ²¡æœ‰æ¥å—å®Œæˆ,ç­‰å¾…ä¸€æ®µæ—¶é—´å,å‘é€1XXå¤šçŠ¶æ€ç **
	* **2XXï¼šæˆåŠŸã€‚ä»£è¡¨ï¼š200**
	* **3XXï¼šé‡å®šå‘ã€‚ä»£è¡¨ï¼š302ï¼ˆé‡å®šå‘ï¼‰ï¼Œ304ï¼ˆè®¿é—®ç¼“å­˜ï¼‰**
	* **4XXï¼šå®¢æˆ·ç«¯é”™è¯¯ã€‚**
	* **ä»£è¡¨ï¼š**
		* **404ï¼ˆè¯·æ±‚è·¯å¾„æ²¡æœ‰å¯¹åº”çš„èµ„æºï¼‰**
		* **405ï¼šè¯·æ±‚æ–¹å¼æ²¡æœ‰å¯¹åº”çš„doXxxæ–¹æ³•**
	* **5XXï¼šæœåŠ¡å™¨ç«¯é”™è¯¯**
	* **ä»£è¡¨ï¼š**
		* **500ï¼ˆæœåŠ¡å™¨å†…éƒ¨å‡ºç°å¼‚å¸¸ï¼‰**



### 2.å“åº”å¤´ï¼š

#### 1.æ ¼å¼ï¼šå¤´åç§°ï¼šå€¼

#### 2.å¸¸è§çš„å“åº”å¤´ï¼š

* **1.Content-Type:æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯æœ¬æ¬¡å“åº”ä½“æ•°æ®æ ¼å¼ä»¥åŠç¼–ç æ ¼å¼**
* **2.Content- disposition:æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯ä»¥ä»€ä¹ˆæ ¼å¼æ‰“å¼€å“åº”ä½“æ•°æ®**
	* **å€¼**
		* **in-lineï¼šé»˜è®¤å€¼ï¼Œåœ¨å½“å‰é¡µé¢å†…æ‰“å¼€**
		* **attachmentï¼›filename=xxxï¼šä»¥é™„ä»¶å½¢å¼æ‰“å¼€å“åº”ä½“ã€‚æ–‡ä»¶ä¸‹è½½**



### 3.å“åº”ç©ºè¡Œ



### 4.å“åº”ä½“ï¼šä¼ è¾“çš„æ•°æ®

* **å“åº”å­—ç¬¦ä¸²æ ¼å¼**

```html
HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
Content-length: 101
Date: Wed. 06 Jun 2018 07: 08: 42 GMT
<html>
	<head>
		<title>$title$</title>
	</head>
	<body>
	hello, response
	</body>
</html>
```





## 3.Request

### 1.requestå¯¹è±¡å’Œresponseå¯¹è±¡çš„åŸç†

* **1.requestå’Œresponseå¯¹è±¡æ˜¯ç”±æœåŠ¡å™¨åˆ›å»ºçš„ï¼Œæˆ‘ä»¬ä½¿ç”¨**
* **2.requestå¯¹è±¡æ˜¯æ¥è·å–è¯·æ±‚æ¶ˆæ¯ï¼Œresponseå¯¹è±¡æ˜¯æ¥è®¾ç½®å“åº”æ¶ˆæ¯**



### 2.requestå¯¹è±¡ç»§æ‰¿ä½“ç³»ç»“æ„ï¼š

* **ServletRequest		 	------		æ¥å£**
* â€‹            **|       ç»§æ‰¿**
* **HttpServletRequest    ------      æ¥å£**
* â€‹            **|        å®ç°**
* **org.apache.catalina.connector.RequestFacade ç±»(Tomcat)**



### 3.requeståŠŸèƒ½ï¼š



#### 1.è·å–è¯·æ±‚æ¶ˆæ¯æ•°æ®

##### 	1.è·å–è¯·æ±‚è¡Œæ•°æ®

* **GET /myServlet/demo1?name=itrs HTTP/1.1**

* **æ–¹æ³•**

* **1.è·å–è¯·æ±‚æ–¹å¼ï¼šGET**

	* String  getMethod()

* **2.â­è·å–è™šæ‹Ÿç›®å½•ï¼š/myServlet**

	* String  getContextPath()

* **3.è·å–Servletè·¯å¾„ï¼š/demo1**

	* String  getServletPath()

* **4.è·å–getæ–¹å¼è¯·æ±‚å‚æ•°ï¼šname = itrs**

	* String  getQueryString()

* **5.â­è·å–è¯·æ±‚URIï¼š/myServlet/demo1**

	* String  getRequestURI():      /myServlet/demo1

	* StringBuffer  getRequestURL()     : http://localhost/myServlet/demo1

		 

	* URLï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼š http://localhost/myServlet/demo1

		* ä¾‹ï¼šä¸­åäººæ°‘å…±å’Œå›½

	* URI :   ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼š/myServlet/demo1

		* ä¾‹ï¼šå…±å’Œå›½

* **6.è·å–åè®®åŠç‰ˆæœ¬ï¼šHTTP/1.1**

	* String  getProtocol()

* **7.è·å–å®¢æˆ·æœºçš„IPåœ°å€:**

	* String  getRemoteAddr()

###### *RequestDemo1

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * æ¼”ç¤ºRequestå¯¹è±¡è·å–è¯·æ±‚è¡Œæ•°æ®
 */
@WebServlet("/requestDemo1")
public class RequestDemo1 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        /*
             1.è·å–è¯·æ±‚æ–¹å¼ï¼šGET
                * String  getMethod()
             2.â­è·å–è™šæ‹Ÿç›®å½•ï¼š/myServlet
                * String  getContextPath()
             3.è·å–Servletè·¯å¾„ï¼š/demo1
                * String  getServletPath()
             4.è·å–getæ–¹å¼è¯·æ±‚å‚æ•°ï¼šname = itrs
                * String  getQueryString()
             5.â­è·å–è¯·æ±‚URIï¼š/myServlet/demo1
                * String  getRequestURI():      /myServlet/requestDemo1
                * StringBuffer  getRequestURL()     :http://localhost/myServlet/requestDemo1
             6.è·å–åè®®åŠç‰ˆæœ¬ï¼šHTTP/1.1
                * String  getProtocol()
             7.è·å–å®¢æˆ·æœºçš„IPåœ°å€:
                * String  getRemoteAddr()
         */
        
        //1.è·å–è¯·æ±‚æ–¹å¼ï¼šGET
        String method = request.getMethod();
        System.out.println(method);

        //2.â­è·å–è™šæ‹Ÿç›®å½•ï¼š/myServlet
        String contextPath = request.getContextPath();
        System.out.println(contextPath);

        //3.è·å–Servletè·¯å¾„ï¼š/demo1
        String servletPath = request.getServletPath();
        System.out.println(servletPath);

        //4.è·å–getæ–¹å¼è¯·æ±‚å‚æ•°ï¼šname = itrs
        String queryString = request.getQueryString();
        System.out.println(queryString);

        //5.â­è·å–è¯·æ±‚URIï¼š/myServlet/demo1
        String requestURI = request.getRequestURI();
        StringBuffer requestURL = request.getRequestURL();
        System.out.println(requestURI);
        System.out.println(requestURL);

        //6.è·å–åè®®åŠç‰ˆæœ¬ï¼šHTTP/1.1
        String protocol = request.getProtocol();
        System.out.println(protocol);

        //7.è·å–å®¢æˆ·æœºçš„IPåœ°å€:
        String remoteAddr = request.getRemoteAddr();
        System.out.println(remoteAddr);

    }
}
```



##### 	2.è·å–è¯·æ±‚å¤´æ•°æ®

* **æ–¹æ³•ï¼š**
* **â­String  getHeader(String  name): é€šè¿‡è¯·æ±‚å¤´çš„åç§°è·å–è¯·æ±‚å¤´çš„å€¼**
* **Enumeration<String>  getHeaderNames(): è·å–æ‰€æœ‰çš„è¯·æ±‚å¤´åç§°**

###### *RequestDemo2

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.Enumeration;

@WebServlet("/requestDemo2")
public class RequestDemo2 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //æ¼”ç¤ºè·å–è¯·æ±‚å¤´æ•°æ®

        //1.è·å–æ‰€æœ‰è¯·æ±‚å¤´åç§°
        Enumeration<String> headerNames = request.getHeaderNames();
        //2.éå†
        while (headerNames.hasMoreElements()){
            String name = headerNames.nextElement();
            //æ ¹æ®åç§°è·å–è¯·æ±‚å¤´çš„å€¼
            String value = request.getHeader(name);
            System.out.println(name+"-----"+value);
        }

    }
}
```

###### *RequestDemo3

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo3")
public class RequestDemo3 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //æ¼”ç¤ºè·å–è¯·æ±‚å¤´æ•°æ®:user-agent

        String agent = request.getHeader("user-agent");
        //åˆ¤æ–­agentçš„æµè§ˆå™¨ç‰ˆæœ¬
        if (agent.contains("Chrome")){
            //è°·æ­Œ
            System.out.println("è°·æ­Œ");
        }else if(agent.contains("Firefox")){
            //ç«ç‹
            System.out.println("ç«ç‹");
        }

    }
}
```

###### *RequestDemo4

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo4")
public class RequestDemo4 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //æ¼”ç¤ºè·å–è¯·æ±‚å¤´æ•°æ®:referer

        String referer = request.getHeader("referer");
        System.out.println(referer);    //http://localhost/myServlet/login.html


        //é˜²ç›—é“¾
        if (referer != null) {
            if (referer.contains("/myServlet")) {
                //æ­£å¸¸è®¿é—®
                //System.out.println("æ’­æ”¾ç”µå½±....");
                /* åœ¨ç½‘é¡µä¸Šè¾“å‡º */
                response.setContentType("text/html;charset=utf-8");
                response.getWriter().write("æ’­æ”¾ç”µå½±....");
            } else {
                //ç›—é“¾
                //System.out.println("ç›—é“¾");
                response.setContentType("text/html;charset=utf-8");
                response.getWriter().write("ç›—é“¾....");
            }
        }

    }
}
```

##### 3.è·å–è¯·æ±‚ä½“æ•°æ®

* **è¯·æ±‚ä½“ï¼šåªæœ‰POSTè¯·æ±‚æ–¹å¼ï¼Œæ‰æœ‰è¯·æ±‚ä½“ï¼Œåœ¨è¯·æ±‚ä½“ä¸­å°è£…äº†POSTè¯·æ±‚çš„è¯·æ±‚å‚æ•°**
* **æ­¥éª¤**
* **1.è·å–æµå¯¹è±¡**
	* **BufferedReader  getReader(): è·å–å­—ç¬¦è¾“å…¥æµï¼Œåªèƒ½æ“ä½œå­—ç¬¦æ•°æ®**
	* **ServletInputStream  getInputStream()ï¼šè·å–å­—èŠ‚è¾“å…¥æµï¼Œå¯ä»¥æ“ä½œæ‰€æœ‰ç±»å‹æ•°æ®**
* **2.å†ä»æµå¯¹è±¡ä¸­æ‹¿æ•°æ®**



###### *regist.html

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>æ³¨å†Œé¡µé¢</title>
</head>
<body>
<form action="/myServlet/requestDemo5" method="post">
    <input type="text" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" name="username"><br>
    <input type="text" placeholder="è¯·è¾“å…¥å¯†ç " name="password"><br>
    <input type="submit" value="æ³¨å†Œ">
</form>
</body>
</html>
```

###### *RequestDemo5

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.BufferedReader;
import java.io.IOException;

@WebServlet("/requestDemo5")
public class RequestDemo5 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //è·å–è¯·æ±‚æ¶ˆæ¯ä½“---è¯·æ±‚å‚æ•°

        //1.è·å–å­—ç¬¦æµ
        BufferedReader br = request.getReader();
        //2.è¯»å–æ•°æ®
        String line = null;
        while ((line = br.readLine())!=null){
            System.out.println(line);
        }
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }
}
```



#### 2.å…¶ä»–åŠŸèƒ½

#####  1.è·å–è¯·æ±‚å‚æ•°é€šç”¨æ–¹å¼:ä¸è®ºgetè¿˜æ˜¯postè¯·æ±‚æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ–¹æ³•æ¥è·å–è¯·æ±‚å‚æ•°

* **1.String getParameter( String name):æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼ 	username=itrs& password=123**

```html
<form action="/myServlet/requestDemo6" method="get">
    <input type="text" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" name="username"><br>
    <input type="text" placeholder="è¯·è¾“å…¥å¯†ç " name="password"><br>
    <input type="submit" value="æ³¨å†Œ">
</form>
    regist2.html
```

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.BufferedReader;
import java.io.IOException;

@WebServlet("/requestDemo6")
public class RequestDemo6 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //post è·å–è¯·æ±‚å‚æ•°

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼
        String username = request.getParameter("username");
        System.out.println("post");
        System.out.println(username);
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //get è·å–è¯·æ±‚å‚æ•°

        /*//æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼
        String username = request.getParameter("username");
        System.out.println("get");
        System.out.println(username);*/

        this.doPost(request,response);
    }
}
```



* **2.String[] getParameterValues( String name):æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼çš„æ•°ç»„     hob by=xx& hobby=game**

```html
<form action="/myServlet/requestDemo6" method="get">
    <input type="text" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" name="username"><br>
    <input type="text" placeholder="è¯·è¾“å…¥å¯†ç " name="password"><br>

    <input type="checkbox" name="hobby" value="game">æ¸¸æˆ
    <input type="checkbox" name="hobby" value="study">å­¦ä¹ 

    <input type="submit" value="æ³¨å†Œ">
</form>
```

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.BufferedReader;
import java.io.IOException;

@WebServlet("/requestDemo6")
public class RequestDemo6 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //post è·å–è¯·æ±‚å‚æ•°

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼
        String username = request.getParameter("username");

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼çš„æ•°ç»„
        String[] hobbies = request.getParameterValues("hobby");
        for (String hobby:hobbies) {
            System.out.println(hobby);
        }
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //get è·å–è¯·æ±‚å‚æ•°

        this.doPost(request,response);
    }
}
```



* **3. Enumeration< String> getParameterNames():è·å–æ‰€æœ‰è¯·æ±‚çš„å‚æ•°åç§°**

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.BufferedReader;
import java.io.IOException;
import java.util.Enumeration;

@WebServlet("/requestDemo6")
public class RequestDemo6 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //post è·å–è¯·æ±‚å‚æ•°

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼
        String username = request.getParameter("username");

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼çš„æ•°ç»„
        String[] hobbies = request.getParameterValues("hobby");

        //è·å–æ‰€æœ‰è¯·æ±‚çš„å‚æ•°åç§°
        Enumeration<String> parameterNames = request.getParameterNames();
        while (parameterNames.hasMoreElements()){
            String name = parameterNames.nextElement();
            System.out.println(name);
            String value = request.getParameter(name);
            System.out.println(value);
            System.out.println("---------------------");
        }
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //get è·å–è¯·æ±‚å‚æ•°

        this.doPost(request,response);
    }
}

/*
	username
    itrs
    ---------------------
    password
    123
    ---------------------
    hobby
    game
    ---------------------
    æ³¨ï¼šåªè¿”å›ä¸€ä¸ªåŒ…å«è¯·æ±‚æ¶ˆæ¯ä¸­æ‰€æœ‰å‚æ•°åç§°Enumerationå¯¹è±¡
*/
```



* **4. Map<String, String[]> getParameterMap():è·å–æ‰€æœ‰å‚æ•°çš„mapé›†åˆ**

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.BufferedReader;
import java.io.IOException;
import java.util.Enumeration;
import java.util.Map;
import java.util.Set;

@WebServlet("/requestDemo6")
public class RequestDemo6 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //post è·å–è¯·æ±‚å‚æ•°

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼
        String username = request.getParameter("username");

        //æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼çš„æ•°ç»„
        String[] hobbies = request.getParameterValues("hobby");
        
        //è·å–æ‰€æœ‰è¯·æ±‚çš„å‚æ•°åç§°
        Enumeration<String> parameterNames = request.getParameterNames();
        
        //è·å–æ‰€æœ‰å‚æ•°çš„mapé›†åˆ
        Map<String, String[]> parameterMap = request.getParameterMap();
        //éå†
        Set<String> keyset = parameterMap.keySet();
        for (String name:keyset) {
            //è·å–é”®è·å–å€¼
            String[] values = parameterMap.get(name);
            System.out.println(name);
            for (String value:values) {
                System.out.println(value);
            }
            System.out.println("------------");
        }
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //get è·å–è¯·æ±‚å‚æ•°

        this.doPost(request,response);
    }
}

/*
	username
    itrs
    ------------
    password
    123
    ------------
    hobby
    game
    study
    ------------
	æ³¨ï¼šç”¨äºå°†è¯·æ±‚æ¶ˆæ¯ä¸­çš„æ‰€æœ‰å‚æ•°åå’Œå€¼è£…è¿›ä¸€ä¸ªMapå¯¹è±¡ä¸­æ”¾å›
*/
```



* **ä¸­æ–‡ä¹±ç é—®é¢˜ï¼š------  RequestDemo7.java**
	* **getæ–¹å¼ï¼štomcat 8 å·²ç»å°† get æ–¹å¼ä¹±ç çš„é—®é¢˜è§£å†³äº†**
	* **postæ–¹å¼ï¼šä¼šä¹±ç **
		* **è§£å†³ï¼šåœ¨è·å–å‚æ•°å‰ï¼Œè®¾ç½®requestçš„ç¼–ç ï¼šrequest.setCharacterEncoding("utf-8");**

##### 2.è¯·æ±‚è½¬å‘:  ä¸€ç§åœ¨æœåŠ¡å™¨å†…éƒ¨çš„èµ„æºè·³è½¬æ–¹å¼

###### 1.æ­¥éª¤ï¼š

* **1.é€šè¿‡ requestå¯¹è±¡è·å–è¯·æ±‚è½¬å‘å™¨å¯¹è±¡: Requestdispatcher getrequestdispatcher( String path)**
* **2.ä½¿ç”¨ RequestDispatcherå¯¹è±¡æ¥è¿›è¡Œè½¬å‘: forward( Servletrequest request, Servletresponse response)**

###### 2.ç‰¹ç‚¹ï¼š

* **1.æµè§ˆå™¨åœ°å€æ è·¯å¾„ä¸å‘ç”Ÿå˜åŒ–**
* **2.åªèƒ½è½¬å‘åˆ°å½“å‰æœåŠ¡å™¨å†…éƒ¨èµ„æºä¸­**
* **3.è½¬å‘æ˜¯ä¸€æ¬¡è¯·æ±‚**

```java
package com.itrs.web.request;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo8")
public class RequestDemo8 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("demo8è¢«è®¿é—®");
        //è½¬å‘åˆ°demo9èµ„æº

//        RequestDispatcher requestDispatcher = request.getRequestDispatcher("/requestDemo9");
//        requestDispatcher.forward(request,response);

        //ä¼˜åŒ–
        request.getRequestDispatcher("/requestDemo9").forward(request,response);
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        this.doPost(request,response);
    }
}
```

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo9")
public class RequestDemo9 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("demo9è¢«è®¿é—®");
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        this.doPost(request,response);
    }
}
```



##### 3.å…±äº«æ•°æ®ï¼š

* **åŸŸå¯¹è±¡ï¼šä¸€ä¸ªæœ‰ä½œç”¨èŒƒå›´çš„å¯¹è±¡ï¼Œå¯ä»¥åœ¨èŒƒå›´å†…å…±äº«æ•°æ®**
* **requeståŸŸï¼šä»£è¡¨ä¸€æ¬¡è¯·æ±‚çš„èŒƒå›´ï¼Œä¸€èˆ¬ç”¨äºè¯·æ±‚è½¬å‘çš„å¤šä¸ªèµ„æºå…±äº«æ•°æ®**
* **æ–¹æ³•ï¼š**
	* **1.void setAttribute( String name, object obj):å­˜å‚¨æ•°æ®**
	* **2.object getAttitude( string name):é€šè¿‡é”®è·å–å€¼**
	* **3.void removeAttribute( String name):é€šè¿‡é”®ç§»é™¤é”®å€¼å¯¹**

```java
package com.itrs.web.request;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo8")
public class RequestDemo8 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("demo8è¢«è®¿é—®");
        //è½¬å‘åˆ°demo9èµ„æº

//        RequestDispatcher requestDispatcher = request.getRequestDispatcher("/requestDemo9");
//        requestDispatcher.forward(request,response);

        //å­˜å‚¨æ•°æ®åˆ°requeståŸŸä¸­
        request.setAttribute("msg","hello");

        //ä¼˜åŒ–
        request.getRequestDispatcher("/requestDemo9").forward(request,response);
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        this.doPost(request,response);
    }
}
```

```java
package com.itrs.web.request;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/requestDemo9")
public class RequestDemo9 extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //è·å–æ•°æ®
        Object msg = request.getAttribute("msg");
        System.out.println(msg);

        System.out.println("demo9è¢«è®¿é—®");
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        this.doPost(request,response);
    }
}
```

##### 4.è·å– ServletContext

* **ServletContext getServletContext()**



## ğŸ”ºæ¡ˆä¾‹ï¼šç”¨æˆ·ç™»å½•

https://www.bilibili.com/video/BV1qv4y1o79t?p=257&spm_id_from=pageDriver

==æ³¨ï¼šéƒ¨åˆ†çŸ¥è¯†æœªå­¦åˆ°ï¼Œå…ˆè·³è¿‡==







## 4.Responseå¯¹è±¡

### åŠŸèƒ½ï¼šè®¾ç½®å“åº”å¼æ¶ˆæ¯

#### 1.è®¾ç½®å“åº”è¡Œ

##### 1.æ ¼å¼ï¼šhttp/1.1  200  OK

##### 2.è®¾ç½®çŠ¶æ€ç ï¼šsetStatusï¼ˆint scï¼‰

#### 2.è®¾ç½®å“åº”å¤´

**setHeaderï¼ˆString name,String valueï¼‰**

#### 3.è®¾ç½®å“åº”ä½“

==**ä½¿ç”¨æ­¥éª¤ï¼š**==

* **1.è·å–è¾“å‡ºæµ**
	* **å­—ç¬¦è¾“å‡ºæµï¼šPrintWriter getWriter()**
	* **å­—ç¬¦è¾“å‡ºæµï¼šServletOutputStream getOutputStream()**
* **2.ä½¿ç”¨è¾“å‡ºæµï¼Œå°†æ•°æ®è¾“å‡ºåˆ°å®¢æˆ·ç«¯æµè§ˆå™¨**



### æ¡ˆä¾‹ï¼š

#### 1.å®Œæˆé‡å®šå‘

* **é‡å®šå‘ï¼šèµ„æºè·³è½¬çš„æ–¹å¼**

* **ä»£ç å®ç°**

* ```java
	package cn.itrs.web.servlet;
	
	import javax.servlet.ServletException;
	import javax.servlet.annotation.WebServlet;
	import javax.servlet.http.HttpServlet;
	import javax.servlet.http.HttpServletRequest;
	import javax.servlet.http.HttpServletResponse;
	import java.io.IOException;
	
	/**
	 * é‡å®šå‘
	 */
	
	@WebServlet("/responseDemo1")
	public class ResponseDemo1 extends HttpServlet{
	    @Override
	    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        this.doPost(req,resp);
	    }
	
	    @Override
	    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	
	        System.out.println("demo1....");
	
	        //è®¿é—®/responseDemo1,ä¼šè‡ªåŠ¨è·³è½¬åˆ°/responseDemoèµ„æº
	        //1.è®¾ç½®çŠ¶æ€ç ä¸º302
	//        resp.setStatus(302);
	        //2.è®¾ç½®å“åº”å¤´location
	//        resp.setHeader("location","/responseDemo2");
	
	        //ç®€å•çš„é‡å®šå‘æ–¹æ³•
	        resp.sendRedirect("/responseDemo2");
	    }
	}
	```

	```java
	package cn.itrs.web.servlet;
	
	import javax.servlet.ServletException;
	import javax.servlet.annotation.WebServlet;
	import javax.servlet.http.HttpServlet;
	import javax.servlet.http.HttpServletRequest;
	import javax.servlet.http.HttpServletResponse;
	import java.io.IOException;
	
	
	@WebServlet("/responseDemo2")
	public class ResponseDemo2 extends HttpServlet{
	    @Override
	    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        this.doPost(req,resp);
	    }
	
	    @Override
	    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        System.out.println("demo222222222......");
	    }
	}
	```



* **é‡å®šå‘çš„ç‰¹ç‚¹ï¼šredirect **

	* **1.åœ°å€æ å‘ç”Ÿå˜åŒ–**

	* **2.é‡å®šå‘å¯ä»¥è®¿é—®å…¶ä»–ç«™ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰çš„èµ„æº**

	* ```java
		//ç®€å•çš„é‡å®šå‘æ–¹æ³•
		//        resp.sendRedirect("/responseDemo2");
		        resp.sendRedirect("http://www.gitee.com");
		```

	* **3.é‡å®šå‘æ˜¯ä¿©æ¬¡è¯·æ±‚ï¼Œä¸èƒ½ä½¿ç”¨requestå¯¹è±¡æ¥å…±äº«æ•°æ®**

* **è½¬å‘çš„ç‰¹ç‚¹ï¼šforward **

	* **1.è½¬å‘åœ°å€æ è·¯å¾„ä¸å˜**
	* **2.è½¬å‘åªèƒ½è®¿é—®å½“å‰æœåŠ¡å™¨ä¸‹çš„èµ„æº**
	* **3.è½¬å‘æ˜¯ä¸€æ¬¡è¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨requestå¯¹è±¡æ¥å…±äº«æ•°æ®**

#### ğŸ”ºé¢è¯•é¢˜ï¼šforward å’Œ redirect åŒºåˆ«

* **è·¯å¾„å†™æ³•ï¼š**
	* **1.ç›¸å¯¹è·¯å¾„ï¼šé€šè¿‡ç›¸å¯¹è·¯å¾„ä¸å¯ä»¥ç¡®å®šå”¯ä¸€èµ„æº**
		* **å¦‚ï¼š./index.html**
		* **ä¸ä»¥/å¼€å¤´ï¼Œ ä»¥  . å¼€å¤´è·¯å¾„**
		* **è§„åˆ™ï¼šæ‰¾åˆ°å½“å‰èµ„æºå’Œç›®æ ‡èµ„æºä¹‹é—´çš„ç›¸å¯¹ä½ç½®å…³ç³»**
			* **./ï¼šå½“å‰ç›®å½•**
			* **../ï¼šåé€€ä¸€çº§ç›®å½•**
	* **2.ç»å¯¹è·¯å¾„ï¼šé€šè¿‡ç»å¯¹è·¯å¾„å¯ä»¥ç¡®å®šå”¯ä¸€èµ„æº**
		* **ä»¥/å¼€å¤´çš„è·¯å¾„**
		* **è§„åˆ™ï¼šåˆ¤æ–­å®šä¹‰çš„è·¯å¾„æ˜¯ç»™è°ç”¨çš„ï¼Ÿåˆ¤æ–­è¯·æ±‚å°†æ¥ä»å“ªé‡Œå‘å‡º**
			* **ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ä½¿ç”¨ï¼šéœ€è¦åŠ è™šæ‹Ÿç›®å½•ï¼ˆé¡¹ç›®çš„è®¿é—®è·¯å¾„ï¼‰**
				* **å»ºè®®è™šæ‹Ÿç›®å½•åŠ¨æ€è·å–ï¼šreq.getContextPath()**
				* **<a>,<form> é‡å®šå‘...**
			* **ç»™æœåŠ¡å™¨ä½¿ç”¨ï¼šä¸éœ€è¦åŠ è™šæ‹Ÿç›®å½•**
				* **è½¬å‘è·¯å¾„**

```java
package cn.itrs.web.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;


@WebServlet("/responseDemo3")
public class ResponseDemo3 extends HttpServlet{
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doPost(req,resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //è½¬å‘
        req.getRequestDispatcher("/responseDemo2").forward(req,resp);
    }
}
```



#### 2.æœåŠ¡å™¨è¾“å‡ºå­—ç¬¦æ•°æ®åˆ°æµè§ˆå™¨

* **æ­¥éª¤ï¼š**

	* **1.è·å–å­—ç¬¦è¾“å‡ºæµ**
	* **2.è¾“å‡ºæ•°æ®**

* **æ³¨æ„ï¼š**

	* **ä¹±ç é—®é¢˜ï¼š**

		* **1.PrintWriter pw = resp.getWriter();  è·å–çš„æµçš„é»˜è®¤ç¼–ç æ˜¯ISO-8859-1**

		* **2.è®¾ç½®è¯¥æµçš„é»˜è®¤ç¼–ç **

		* **3.å‘Šè¯‰æµè§ˆå™¨å“åº”ä½“ä½¿ç”¨çš„ç¼–ç **

		* ```java
			//ç®€å•çš„å½¢å¼ï¼Œè®¾ç½®ç¼–ç 
			resp.setContentType("text/html;charset=utf-8");
			```

```java
package cn.itrs.web.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.io.PrintWriter;


@WebServlet("/responseDemo4")
public class ResponseDemo4 extends HttpServlet{
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doPost(req,resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //è·å–æµå¯¹è±¡ä¹‹å‰ï¼Œè®¾ç½®æµçš„é»˜è®¤ç¼–ç ï¼šISO-8859-1 è®¾ç½®ä¸ºï¼šGBK
//        resp.setCharacterEncoding("GBK");

        // å‘Šè¯‰æµè§ˆå™¨ï¼ŒæœåŠ¡å™¨å‘é€çš„æ¶ˆæ¯ä½“æ•°æ®çš„ç¼–ç ï¼Œå»ºè®®æµè§ˆå™¨ä½¿ç”¨è¯¥ç¼–ç è§£ç 
//        resp.setHeader("content-type","text/html;charset=utf-8");

        //ç®€å•çš„å½¢å¼ï¼Œè®¾ç½®ç¼–ç 
        resp.setContentType("text/html;charset=utf-8");

        //1.è·å–å­—ç¬¦è¾“å‡ºæµ
        PrintWriter pw = resp.getWriter();
        //2.è¾“å‡ºæ•°æ®
//        pw.write("<h1>hello response</h1>");
        pw.write("<h1>è¾“å‡ºæ•°æ®</h1>");

    }
}
```



#### 3.æœåŠ¡å™¨è¾“å‡ºå­—èŠ‚æ•°æ®åˆ°æµè§ˆå™¨

* **æ­¥éª¤ï¼š**

	* **1.è·å–å­—èŠ‚è¾“å‡ºæµ**
	* **2.è¾“å‡ºæ•°æ®**

* ```java
	package cn.itrs.web.servlet;
	
	import javax.servlet.ServletException;
	import javax.servlet.ServletOutputStream;
	import javax.servlet.annotation.WebServlet;
	import javax.servlet.http.HttpServlet;
	import javax.servlet.http.HttpServletRequest;
	import javax.servlet.http.HttpServletResponse;
	import java.io.IOException;
	
	
	@WebServlet("/responseDemo5")
	public class ResponseDemo5 extends HttpServlet{
	    @Override
	    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        this.doPost(req,resp);
	    }
	
	    @Override
	    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        resp.setContentType("text/html;charset=utf-8");
	
	        //1.è·å–å­—èŠ‚è¾“å‡ºæµ
	        ServletOutputStream sos = resp.getOutputStream();
	        //2.è¾“å‡ºæ•°æ®
	        sos.write("ä½ å¥½".getBytes("utf-8"));
	    }
	}
	```

	

#### 4.éªŒè¯ç 

* **1.æœ¬è´¨ï¼šå›¾ç‰‡**

* **2.ç›®çš„ï¼šé˜²æ­¢æ¶æ„è¡¨å•æ³¨å†Œ**

* ```java
	package cn.itrs.web.servlet;
	
	import javax.imageio.ImageIO;
	import javax.servlet.ServletException;
	
	import javax.servlet.annotation.WebServlet;
	import javax.servlet.http.HttpServlet;
	import javax.servlet.http.HttpServletRequest;
	import javax.servlet.http.HttpServletResponse;
	import java.awt.*;
	import java.awt.image.BufferedImage;
	import java.io.IOException;
	import java.util.Random;
	
	
	@WebServlet("/checkCodeServlet")
	public class checkCodeServerlet extends HttpServlet{
	    @Override
	    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        this.doPost(req,resp);
	    }
	
	    @Override
	    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	        int width = 100;
	        int height = 50;
	
	        //1.åˆ›å»ºä¸€å¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­å›¾ç‰‡ï¼ˆéªŒè¯ç å›¾ç‰‡å¯¹è±¡ï¼‰
	        BufferedImage image = new BufferedImage(width,height,BufferedImage.TYPE_INT_RGB);
	        //2.ç¾åŒ–å›¾ç‰‡
	        //2.1å¡«å……èƒŒæ™¯è‰²
	        Graphics g = image.getGraphics();//ç”»ç¬”å¯¹è±¡
	        g.setColor(Color.PINK);//è®¾ç½®ç”»ç¬”é¢œè‰²
	        g.fillRect(0,0,width,height);
	
	        //2.2ç”»è¾¹æ¡†
	        g.setColor(Color.BLUE);
	        g.drawRect(0,0,width-1,height-1);
	
	        String str = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
	        //ç”Ÿæˆéšæœºè§’æ ‡
	        Random random = new Random();
	        for (int i = 1; i <=4 ; i++) {
	            int index = random.nextInt(str.length());
	            //è·å–å­—ç¬¦
	            char ch = str.charAt(index);//éšæœºå­—ç¬¦
	            // 2.3å†™éªŒè¯ç 
	            g.drawString(ch+"",width/5*i,height/2);
	        }
	
	        //2.4ç”»å¹²æ‰°çº¿
	        g.setColor(Color.green);
	        //éšæœºç”Ÿæˆåæ ‡ç‚¹
	        for (int i = 0; i <10 ; i++) {
	            int x1 = random.nextInt(width);
	            int x2 = random.nextInt(width);
	
	            int y1 = random.nextInt(height);
	            int y2 = random.nextInt(height);
	            g.drawLine(x1,y1,x2,y2);
	        }
	
	        //3.å°†å›¾ç‰‡è¾“å‡ºåˆ°é¡µé¢å±•ç¤º
	        ImageIO.write(image,"jpg",resp.getOutputStream());
	    }
	}
	```

	```html
	<!DOCTYPE html>
	<html lang="en">
	<head>
	    <meta charset="UTF-8">
	    <title>Title</title>
	    <script>
	        /*
	            åˆ†æï¼š
	            ç‚¹å‡»è¶…é“¾æ¥æˆ–è€…å›¾ç‰‡ï¼Œæ¢ä¸€å¼ 
	            1.ç»™è¶…é“¾æ¥å’Œå›¾ç‰‡ç»‘å®šå•å‡»æ—¶é—´
	
	            2.é‡æ–°è®¾ç½®å›¾ç‰‡çš„srcå±æ€§å€¼
	         */
	        window.onload = function (ev) {
	            //1.è·å–å›¾ç‰‡å¯¹è±¡
	            var img = document.getElementById("checkCode");
	            //2.ç»‘å®šå•å‡»äº‹ä»¶
	            img.onclick = function (ev1) {
	                //åŠ æ—¶é—´æˆ³
	                var date = new Date().getTime();
	
	                img.src = "/checkCodeServlet?"+date;
	            }
	
	            var on = document.getElementById("change");
	            on.onclick = function (ev1) {
	                // var date = new Date().getTime();
	                // on.href = "";
	            }
	        }
	    </script>
	</head>
	<body>
	<img id="checkCode" src="/checkCodeServlet"/>
	<a id="change" href="">çœ‹ä¸æ¸…æ¢ä¸€å¼ ï¼Ÿ</a>
	</body>
	</html>
	```

	



## 5.ServletContextå¯¹è±¡

### 1.æ¦‚å¿µï¼š

==**ä»£è¡¨æ•´ä¸ªwebåº”ç”¨ï¼Œå¯ä»¥å’Œç¨‹åºçš„å®¹å™¨ï¼ˆæœåŠ¡å™¨ï¼‰æ¥é€šä¿¡**==

### 2.è·å–ï¼š

#### 1.é€šè¿‡requestå¯¹è±¡è·å–

==**req.getServletContext();**==

#### 2.é€šè¿‡HttpServletè·å–

==**this.getServletContext();**==

```java
package cn.itrs.web.servlet;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/servletContextDemo1")
public class ServletContextDemo1 extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        /*
        ServletContextå¯¹è±¡è·å–ï¼š
            1.é€šè¿‡requestå¯¹è±¡è·å–
                req.getServletContext();
            2.é€šè¿‡HttpServletè·å–
                this.getServletContext();
         */

        //1.é€šè¿‡requestå¯¹è±¡è·å–
        ServletContext context1 = req.getServletContext();
        //2.é€šè¿‡HttpServletè·å–
        ServletContext context2 = this.getServletContext();

        System.out.println(context1);
        System.out.println(context2);

        System.out.println(context1==context2);//true
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req,resp);
    }
}
```

### 2.åŠŸèƒ½ï¼š

#### 1.è·å–ï¼šMIMEç±»å‹ï¼š

* **MIMEç±»å‹ï¼šåœ¨äº’è”ç½‘é€šä¿¡è¿‡ç¨‹ä¸­å®šä¹‰çš„ä¸€ç§æ–‡ä»¶æ•°æ®ç±»å‹**
	* **æ ¼å¼ï¼šå¤§ç±»å‹/å°ç±»å‹   text/html    image/jpeg**
* **è·å–ï¼šString getMimeType(String file)**

```java
package cn.itrs.web.servletcontext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/servletContextDemo2")
public class ServletContextDemo2 extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        /*
        ServletContextåŠŸèƒ½ï¼š
           1.è·å–ï¼šMIMEç±»å‹ï¼š
                MIMEç±»å‹ï¼šåœ¨äº’è”ç½‘é€šä¿¡è¿‡ç¨‹ä¸­å®šä¹‰çš„ä¸€ç§æ–‡ä»¶æ•°æ®ç±»å‹
	                æ ¼å¼ï¼šå¤§ç±»å‹/å°ç±»å‹   text/html    image/jpeg
                è·å–ï¼šString getMimeType(String file)
            2.åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®
            3.è·å–æ–‡ä»¶çš„çœŸå®ï¼ˆæœåŠ¡å™¨ï¼‰è·¯å¾„
         */


        //2.é€šè¿‡HttpServletè·å–
        ServletContext context = this.getServletContext();

        //3.å®šä¹‰æ–‡ä»¶åç§°
        String filename = "a.jpg";//image/jpeg

        //4.è·å–MIMEç±»å‹
        String mimeType = context.getMimeType(filename);
        System.out.println(mimeType);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req,resp);
    }
}
```



#### 2.åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®

* **1.setAttribute(String name,Object value)**
* **2.getAttribute(String name)**
* **3.removeAttribute(String name)**
* **ServletContextå¯¹è±¡èŒƒå›´ï¼šæ‰€æœ‰ç”¨æˆ·æ‰€æœ‰è¯·æ±‚çš„æ•°æ®**

```java
package cn.itrs.web.servletcontext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/servletContextDemo3")
public class ServletContextDemo3 extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        /*
        ServletContextåŠŸèƒ½ï¼š
           1.è·å–ï¼šMIMEç±»å‹ï¼š
            2.åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®
            3.è·å–æ–‡ä»¶çš„çœŸå®ï¼ˆæœåŠ¡å™¨ï¼‰è·¯å¾„
         */


        //2.é€šè¿‡HttpServletè·å–
        ServletContext context = this.getServletContext();

        //è®¾ç½®æ•°æ®
        context.setAttribute("msg","haha");

        //3.å®šä¹‰æ–‡ä»¶åç§°
        String filename = "a.jpg";//image/jpeg

        //4.è·å–MIMEç±»å‹
        String mimeType = context.getMimeType(filename);
        System.out.println(mimeType);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req,resp);
    }
}
```

```java
package cn.itrs.web.servletcontext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/servletContextDemo4")
public class ServletContextDemo4 extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        /*
        ServletContextåŠŸèƒ½ï¼š
           1.è·å–ï¼šMIMEç±»å‹ï¼š
            2.åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®
            3.è·å–æ–‡ä»¶çš„çœŸå®ï¼ˆæœåŠ¡å™¨ï¼‰è·¯å¾„
         */


        //2.é€šè¿‡HttpServletè·å–
        ServletContext context = this.getServletContext();

        //è·å–æ•°æ®
        Object msg = context.getAttribute("msg");
        System.out.println(msg);

        //3.å®šä¹‰æ–‡ä»¶åç§°
        String filename = "a.jpg";//image/jpeg

        //4.è·å–MIMEç±»å‹
        String mimeType = context.getMimeType(filename);
        System.out.println(mimeType);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req,resp);
    }
}
```



#### 3.è·å–æ–‡ä»¶çš„çœŸå®ï¼ˆæœåŠ¡å™¨ï¼‰è·¯å¾„

* **æ–¹æ³•ï¼šString getRealPath(String path)**

```java
package cn.itrs.web.servletcontext;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/servletContextDemo4")
public class ServletContextDemo5 extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        /*
        ServletContextåŠŸèƒ½ï¼š
           1.è·å–ï¼šMIMEç±»å‹ï¼š
            2.åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®
            3.è·å–æ–‡ä»¶çš„çœŸå®ï¼ˆæœåŠ¡å™¨ï¼‰è·¯å¾„
         */
        
        //2.é€šè¿‡HttpServletè·å–
        ServletContext context = this.getServletContext();

        //è·å–æ–‡ä»¶çš„æœåŠ¡å™¨è·¯å¾„
        String realPath = context.getRealPath("/b.txt");//webç›®å½•ä¸‹èµ„æºè®¿é—®
        System.out.println(realPath);

        String c = context.getRealPath("/WEB-INF/c.txt");//WEB-INF ç›®å½•ä¸‹çš„èµ„æºè®¿é—®
        System.out.println(c);

        String a = context.getRealPath("/WEB-INf/classes/a.txt");//srcç›®å½•ä¸‹çš„èµ„æºè®¿é—®
        System.out.println(a);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req,resp);
    }
}
```



## 6.æ¡ˆä¾‹ï¼š

[é»‘é©¬ç¨‹åºå‘˜JavaWebå…¨å¥—åŸºç¡€æ•™ç¨‹ï¼ŒJava Webä»å…¥é—¨åˆ°é¡¹ç›®å®æˆ˜ï¼ˆIDEAç‰ˆï¼‰_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1qv4y1o79t?p=282&spm_id_from=pageDriver)

### 1.æ–‡ä»¶ä¸‹è½½éœ€æ±‚ï¼š

#### 1.é¡µé¢æ˜¾ç¤ºè¶…é“¾æ¥

#### 2.ç‚¹å‡»è¶…é“¾æ¥åå¼¹å‡ºä¸‹è½½æç¤ºæ¡†

#### 3.å®Œæˆå›¾ç‰‡æ–‡ä»¶ä¸‹è½½

